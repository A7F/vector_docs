# Test Service Library: Status Report Functions

[Open topic with navigation](../../../../CANoeDEFamily.htm#Topics/CAPLFunctions/Test/CAPLfunctionsTSLStatusReportFunctions.md)

**CAPL Functions** » **Test Service Library** » Status Report Functions

**Valid for**: CANoe DE • CANoe:lite DE • CANoe4SW DE • CANoe4SW:lite DE

In order to query information about a check, generic and check specific status report functions are implemented. The general status report functions are working with all types of checks. The check specific status report functions are working only with a special part of the checks. If a check specific status report function is called for a check that does not support this function, a warning will be displayed in the Write Window.

## Mode of Operation

The goal of the following functions is to give a value for the quality of the system, but the quality depends heavily on the runtime of the check. For statistical reasons, all values are derived in a way that an error event is supposed just before the check has been started and just after the check has been stopped. So the maximum time between events will never be greater than the time between the event and check start and the time between the event and check stop.

At first, session 1 is performed. The red arrows are marking error events, the yellow triangles are marking particular times, the following description will refer.

After the first session, the following statistical values could be queried at the time **"query #1"**:

- min distance = t1
- max distance = t2

Then the session 2 is started without resetting the check. At the time **"query #2"**, the following statistical values could be queried (while the check is running).

- min distance = t1
- max distance = t10a

After this session at **"query #3"**, the following results will occur:

- min distance = t12
- max distance = t10

### Generic Status Report Functions

These functions return statistics on the number of events that any check generated since its creation or reset. They also include functions to convert the check status to a string, for logging. Generic status report functions are available for all check types.

These query functions may **not raise an error class** that leads to a measurement stop.

- [ChkQuery_NumEvents](Functions/CAPLfunctionChkQueryNumEvents.md): Returns the number of events generated by this check since its initialization.
- [ChkQuery_NumEvents_AsyncResult](Functions/CAPLfunctionChkQueryNumEventsAsyncResult.md): Returns the number of events generated by this check since its initialization.
- [ChkQuery_Valid](Functions/CAPLfunctionChkQueryValid.md): Examines whether a check with particular Id is valid.
- [ChkQuery_Valid_AsyncResult](Functions/CAPLfunctionChkQueryValidAsyncResult.md): Examines whether a check with particular Id is valid.
- [StmQuery_Valid](Functions/CAPLfunctionStmQueryValid.md): Examines whether a stimulus with particular Id is valid.

### Statistic Data Collection

The following functions return a timely distance given in the actual precision. The decimal places are cut. To get a value with more decimals (more exact value), the precision can be modified with [ChkConfig_SetPrecision](Functions/CAPLfunctionChkConfigSetPrecision.md).

- [ChkQuery_Precision_AsyncResult](Functions/CAPLfunctionChkQueryPrecision_AsyncResult.md): Returns a factor that can be multiplied with the return value of the statistical queries.
- [ChkQuery_StatEventFreePeriodAvg](Functions/CAPLfunctionChkQueryStatEventFreePeriodAvg.md): Returns the average timely distance between events and check starts/stops.
- [ChkQuery_StatEventFreePeriodAvg_AsyncResult](Functions/CAPLfunctionChkQueryStatEventFreePeriodAvgAsyncResult.md): Returns the average timely distance between events and check starts/stops.
- [ChkQuery_StatEventFreePeriodMax](Functions/CAPLfunctionChkQueryStatEventFreePeriodMax.md): Returns the maximum timely distance between events and check starts/stops.
- [ChkQuery_StatEventFreePeriodMax_AsyncResult](Functions/CAPLfunctionChkQueryStatEventFreePeriodMaxAsyncResult.md): Returns the maximum timely distance between events and check starts/stops.
- [ChkQuery_StatEventFreePeriodMed](Functions/CAPLfunctionChkQueryStatEventFreePeriodMed.md): Returns the average timely distance between events and check starts/stops.
- [ChkQuery_StatEventFreePeriodMed_AsyncResult](Functions/CAPLfunctionChkQueryStatEventFreePeriodMedAsyncResult.md): Returns the average timely distance between events and check starts/stops.
- [ChkQuery_StatEventFreePeriodMin](Functions/CAPLfunctionChkQueryStatEventFreePeriodMin.md): Returns the minimum timely distance between events and check starts/stops.
- [ChkQuery_StatEventFreePeriodMin_AsyncResult](Functions/CAPLfunctionChkQueryStatEventFreePeriodMinAsyncResult.md): Returns the minimum timely distance between events and check starts/stops.
- [ChkQuery_StatProbeIntervalAvg](Functions/CAPLfunctionChkQueryStatProbeIntervalAvg.md): Returns the average timely distance between 2 consumed message events.
- [ChkQuery_StatProbeIntervalAvg_AsyncResult](Functions/CAPLfunctionChkQueryStatProbeIntervalAvgAsyncResult.md): Returns the average timely distance between 2 consumed message events.
- [ChkQuery_StatProbeIntervalMax](Functions/CAPLfunctionChkQueryStatProbeIntervalMax.md): Returns the maximum timely distance between 2 consumed message events.
- [ChkQuery_StatProbeIntervalMax_AsyncResult](Functions/CAPLfunctionChkQueryStatProbeIntervalMaxAsyncResult.md): Returns the maximum timely distance between 2 consumed message events.
- [ChkQuery_StatProbeIntervalMin](Functions/CAPLfunctionChkQueryStatProbeIntervalMin.md): Returns the minimum timely distance between 2 consumed message events.
- [ChkQuery_StatProbeIntervalMin_AsyncResult](Functions/CAPLfunctionChkQueryStatProbeIntervalMinAsyncResult.md): Returns the minimum timely distance between 2 consumed message events.

### Generic Textual Status Report Functions

- [ChkQuery_EventStatus](Functions/CAPLfunctionChkQueryEventStatus.md): Converts the status into a string that can be printed.
- [ChkQuery_EventStatus_AsyncResult](Functions/CAPLfunctionChkQueryEventStatusAsyncResult.md): Converts the status into a string that can be printed.

The following functions allow the easy writing of the status text to different output sinks.

- [ChkQuery_EventStatusToLog](Functions/CAPLfunctionChkQueryEventStatusToLog.md): Uses the output of [ChkQuery_EventStatus](Functions/CAPLfunctionChkQueryEventStatus.md) and writes the result to the logging file.
- [ChkQuery_EventStatusToWrite](Functions/CAPLfunctionChkQueryEventStatusToWrite.md): Uses the output of [ChkQuery_EventStatus](Functions/CAPLfunctionChkQueryEventStatus.md) and writes the result to the logging file.

- [ChkQuery_StatNumProbes](Functions/CAPLfunctionChkQueryStatNumProbes.md): Returns the number of probes (measurements) that have been considered by the check.
- [ChkQuery_StatNumProbes_AsyncResult](Functions/CAPLfunctionChkQueryStatNumProbesAsyncResult.md): Returns the number of samples (probes) that have been considered by the check.

### Check Specific Status Report Functions

The check-specific status report functions permit querying of information that is only available for some types of checks. Which queries are possible and meaningful depend on the purposes of the individual checks. Included in the description of individual check types are definitions of which check-specific Status Report functions are supported.

- [ChkQuery_EventInterval](Functions/CAPLfunctionChkQueryEventInterval.md): Returns the last time-interval that has led to the event.
- [ChkQuery_EventInterval_AsyncResult](Functions/CAPLfunctionChkQueryEventIntervalAsyncResult.md): Returns the last time-interval that has led to the event.
- [ChkQuery_EventMessageId](Functions/CAPLfunctionChkQueryEventMessageId.md): Returns the Id of the message that has forced the event.
- [ChkQuery_EventMessageName](Functions/CAPLfunctionChkQueryEventMessageName.md): Stores the name of the message in a buffer.
- [ChkQuery_EventSignalValue](Functions/CAPLfunctionChkQueryEventSignalValue.md): Enables access to the signal value which was last reported by a check as invalid.
- [ChkQuery_EventSignalValue_AsyncResult](Functions/CAPLfunctionChkQueryEventSignalValueAsyncResult.md): Enables access to the signal value which was last reported by a check as invalid.
- [ChkQuery_EventSignalValueMin](Functions/CAPLfunctionChkQueryEventSignalValueMinMax.md): Enables access to the minimal measured values within a check.
- [ChkQuery_EventSignalValueMax](Functions/CAPLfunctionChkQueryEventSignalValueMinMax.md): Enables access to the minimal measured values within a check.
- [ChkQuery_EventSignalValueMin_AsyncResult, ChkQuery_EventSignalValueMax_AsyncResult](Functions/CAPLfunctionChkQueryEventSignalValueMinMaxAsyncResult.md): Returns the last time-interval that has led to the event.
- [ChkQuery_EventSignalValue (for signals with positive values)](Functions/CAPLfunctionChkQueryEventSignalValuePositive.md): Enables access to the signal (only with positive) value which was last reported by a check as invalid.
- [ChkQuery_EventTimeStamp](Functions/CAPLfunctionChkQueryEventTimeStamp.md): Retrieves time stamp of last fired event.
- [ChkQuery_EventTimestamp_AsyncResult](Functions/CAPLfunctionChkQueryEventTimestampAsyncResult.md): Retrieves time stamp of last fired event.
- [ChkQuery_EventTimeStampInt64](Functions/CAPLfunctionChkQueryEventTimeStampInt64.md): Retrieves time stamp of last fired event.
- [ChkQuery_EventTimestamp64_AsyncResult](Functions/CAPLfunctionChkQueryEventTimestamp64AsyncResult.md): Retrieves time stamp of last fired event.

### MOST Specific Functions

- [ChkQuery_NumRequests](Functions/CAPLfunctionChkQueryNumRequests.md): Returns the total number of requests that occurred during the current observation period.
- [ChkQuery_NumTimedoutRequests](Functions/CAPLfunctionChkQueryNumTimedoutRequests.md): Returns the number of requests within the current observation period for which no corresponding response message was observed during the specified timeout.
- [ChkQuery_RequestDstAdr](Functions/CAPLfunctionChkQueryRequestDstAdr.md): Returns the destination address of the request message, which last led to a protocol violation.
- [ChkQuery_RequestFBlockId](Functions/CAPLfunctionChkQueryRequestFBlockId.md): Returns the FBlock of the request message, which last led to a protocol violation.
- [ChkQuery_RequestFunctionId](Functions/CAPLfunctionChkQueryRequestFunctionId.md): Returns the FunctionID of the request message, which last led to a protocol violation.
- [ChkQuery_RequestInstId](Functions/CAPLfunctionChkQueryRequestInstId.md): Returns the InstID of the request message, which last led to a protocol violation.
- [ChkQuery_RequestOpType](Functions/CAPLfunctionChkQueryRequestOpType.md): Returns the OpType of the request message, which last led to a protocol violation.
- [ChkQuery_RequestSrcAdr](Functions/CAPLfunctionChkQueryRequestSrcAdr.md): Returns the source address of the request message, which last led to a protocol violation.
- [ChkQuery_RequestTimestamp](Functions/CAPLfunctionChkQueryRequestTimestamp.md): Returns the reception time stamp of the request message, which last led to a protocol violation.
- [ChkQuery_StatAvResponseTime](Functions/CAPLfunctionChkQueryStatAvResponseTime.md): Returns the average time lag between the request and corresponding response messages.
- [ChkQuery_StatMaxValidResponseTime](Functions/CAPLfunctionChkQueryStatMaxValidResponseTime.md): Returns the longest time lag between the request and corresponding response message that occurred during the current observation period.
- [ChkQuery_StatMinResponseTime](Functions/CAPLfunctionChkQueryStatMinResponseTime.md): Returns the shortest time lag between the request and corresponding response message that occurred during the current observation period.

### LIN Specific Functions

- [ChkQuery_EventFrameID](Functions/CAPLfunctionChkQueryEventFrameId.md): Retrieves frame id of a schedule table for which the event has been sent.
- [ChkQuery_EventMessageContents](Functions/CAPLfunctionChkQueryEventMessageContents.md): Stores the data bytes of the message into a buffer.
- [ChkQuery_EventNodeName](Functions/CAPLfunctionChkQueryEventNodeName.md): Stores the name of the node into a buffer.
- [ChkQuery_EventSchedSlotIndex](Functions/CAPLfunctionChkQueryEventSchedSlotIndex.md): Retrieves slot index of a schedule table for which the event has been sent.
- [ChkQuery_EventReason](Functions/CAPLfunctionChkQueryEventReason.md): Retrieves the exact reason of firing event in the LIN specific check.
- [ChkQuery_EventTiming](Functions/CAPLfunctionChkQueryEventTiming.md): Retrieves the timing value that has been violated in the LIN specific check.

## Asynchronous Evaluation

Special care must be taken when the checks are evaluated asynchronously and status values are to be queried. Since the values are not available in the RT kernel they need to be requested explicitly before each use. The status values are requested with the function [testWaitForCheckQuery](Functions/CAPLfunctionTestWaitForCheckQuery.md). For every status report function (for example [ChkQuery_EventStatus](Functions/CAPLfunctionChkQueryEventStatus.md)) there is a corresponding function with the same name and the suffix `_AsyncResult` (for example [ChkQuery_EventStatus_AsyncResult](Functions/CAPLfunctionChkQueryEventStatusAsyncResult.md)) which retrieves the requested values from the asynchronous evaluation.

A call to `testWaitForCheckQuery` retrieves all possible status values from the asynchronous evaluation for the given check. Therefore, it is possible to query multiple values with a single call to `testWaitForCheckQuery`.

The following example code shows how status report functions can be used for checks that are evaluated asynchronously.

```plaintext
dword checkId;
dword res;
double doubleRes;
int eventTimestamp;
int numEvents;
checkId = ChkStart_SignalValueChange(sysvar::TestCheckQuery::MySysVar);
// ... test execution
// query values after test execution
res = testWaitForCheckQuery(checkId, 1000);
doubleRes = ChkQuery_EventSignalValue_AsyncResult(checkId);
eventTimestamp = ChkQuery_EventTimestamp_AsyncResult(checkId);
numEvents = ChkQuery_NumEvents_AsyncResult(checkId);
```

Please be aware that the retrieved information should be used only at the (simulation) time when the function `testWaitForCheckQuery` resumed. A warning will be triggered if you use any of the **TestWaitFor...** functions before you actually query any of the information. The following example will give you such a warning message.

```plaintext
dword checkId;
dword res;
int numEvents;
checkId = ChkStart_SignalValueChange(sysvar::TestCheckQuery::MySysVar);
// ... test execution
// query values after execution
res = testWaitForCheckQuery(checkId, 10000000);
testWaitForTimeout(10);
// the following call will trigger the following warning in the test report:
// Result of CheckQuery might be outdated.
numEvents = ChkQuery_NumEvents_AsyncResult(checkId);
```

The function `testWaitForCheckQuery` together with `ChkQuery_<function name>_AsyncResult` can also be used when the checks are evaluated synchronously. In this case `testWaitForCheckQuery` returns immediately.
